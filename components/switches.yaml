# █▀▀ █▀▀ █▄ █ █▀▀ █▀█ ▄▀█ █   #
# █▄█ ██▄ █ ▀█ ██▄ █▀▄ █▀█ █▄▄ #

  - platform: template
    switches:
      # Water kettle @ keuken
      keuken_waterkoker:
        friendly_name: Keuken Waterkoker
        unique_id: keuken_waterkoker
        value_template: "{{ is_state('switch.keuken_smart_plug', 'on') }}"
        availability_template: "{{ states('switch.keuken_smart_plug') != 'unavailable' }}"
        icon_template: >-
          {% if is_state('sensor.keuken_smart_plug_power', '0') %}
            mdi:kettle
          {% else %}
            mdi:kettle-steam
          {% endif %}
        turn_on:
          service: switch.turn_on
          entity_id: switch.keuken_smart_plug
        turn_off:
          service: switch.turn_off
          entity_id: switch.keuken_smart_plug

      # Security cam @ woonkamer
      security_cam:
        friendly_name: Security Cam
        unique_id: security_cam
        value_template: "{{ is_state('switch.aqara_g2h', 'on') }}"
        availability_template: "{{ states('switch.aqara_g2h') != 'unavailable' }}"
        icon_template: >-
          {% if is_state('switch.aqara_g2h', 'on') %}
            mdi:webcam
          {% else %}
            mdi:webcam-off
          {% endif %}
        turn_on:
          service: switch.turn_on
          entity_id: switch.aqara_g2h
        turn_off:
          service: switch.turn_off
          entity_id: switch.aqara_g2h

    # Duux ThreeSixty on/off using Tuya hvac_mode 
  - platform: template
    switches:
      threesixty:
        friendly_name: Duux ThreeSixty Power
        unique_id: duux_threesixty_power
        icon_template: mdi:hvac
        turn_on:
          - service: climate.set_hvac_mode
            data:
              hvac_mode: 'auto'
            entity_id: climate.tuya_threesixty_v2
          - service: select.select_option
            target:
              entity_id: select.duux_threesixty_temperature_level
            data:
              option: '3'
        turn_off:
          service: climate.set_hvac_mode
          data:
            hvac_mode: 'off'
          entity_id: climate.tuya_threesixty_v2

      # Set soundbar installation source to TV
      soundbar_source_tv:
        friendly_name: Soundbar TV
        unique_id: soundbar_tv
        value_template: "{{ is_state_attr('media_player.sonos_arc', 'source', 'TV') }}"
        availability_template: "{{ states('media_player.sonos_arc') != 'unavailable' }}"
        icon_template: mdi:youtube-tv
        turn_on:
          service: media_player.select_source
          entity_id: media_player.sonos_arc
          data:
            source: TV
        turn_off:
          service: script.dummy

    # Adaptive Lighting for woonkamer area
  - platform: template
    switches:
      begane_grond_adaptive_lighting:
        friendly_name: Begane Grond - Adaptive Lighting
        unique_id: adaptive_lighting_begane_grond
        icon_template: mdi:sun-wireless-outline
        turn_on:
          - service: adaptive_lighting.set_manual_control
            entity_id: switch.adaptive_lighting_woonkamer
            data:
              manual_control: false
          - service: adaptive_lighting.set_manual_control
            entity_id: switch.adaptive_lighting_filaments
            data:
              manual_control: false
        turn_off:
          - service: adaptive_lighting.set_manual_control
            entity_id: switch.adaptive_lighting_woonkamer
          - service: adaptive_lighting.set_manual_control
            entity_id: switch.adaptive_lighting_filaments

# ▀█▀ █▀█ ▄▀█ █▀▀ █▄▀ █▀▀ █▀█ █▀ #
#  █  █▀▄ █▀█ █▄▄ █ █ ██▄ █▀▄ ▄█ #

  - platform: template
    switches:
      # HomeKit tracker for Gabriel
      gabriel_home:
        friendly_name: Gabriel Home
        unique_id: switch_gabriel_home
        icon_template: >-
          {% if is_state('device_tracker.gabriel', 'home') %}
            mdi:account-check
          {% else %}
            mdi:account-cancel
          {% endif %}
        turn_on:
          service: device_tracker.see
          data:
            dev_id: gabriel
            location_name: home
        turn_off:
          service: device_tracker.see
          data:
            dev_id: gabriel
            location_name: not_home

      # HomeKit tracker for Shanna
      shanna_home:
        friendly_name: Shanna Home
        unique_id: switch_shanna_home
        icon_template: >-
          {% if is_state('device_tracker.shanna', 'home') %}
            mdi:account-check
          {% else %}
            mdi:account-cancel
          {% endif %}
        turn_on:
          service: device_tracker.see
          data:
            dev_id: shanna
            location_name: home
        turn_off:
          service: device_tracker.see
          data:
            dev_id: shanna
            location_name: not_home

# █▀▄▀█ █▀█ █▀▄ █▀▀ █▀ #
# █ ▀ █ █▄█ █▄▀ ██▄ ▄█ #

  - platform: template
    switches:
      # Privacy Mode
      privacy_mode:
        friendly_name: Privacy Mode
        unique_id: switch_privacy_mode
        icon_template: mdi:heart-circle
        turn_on:
          - service: script.turn_on
            entity_id: script.mode_privacy
        turn_off:
          - service: light.turn_off
            entity_id: light.woonkamer_groep
          - service: light.turn_off
            entity_id: light.keuken_groep
          - service: switch.turn_on
            data_template:
              entity_id: >
                {% if is_state("input_select.home_state", "Day")%}
                  switch.day_state
                {% else %}
                  switch.evening_state
                {% endif %}

      # Party Mode
      party_mode:
        friendly_name: Party Mode
        unique_id: switch_party_mode
        icon_template: mdi:account-supervisor-circle
        turn_on:
          - service: script.turn_on
            entity_id: script.mode_party
        turn_off:
          - service: light.turn_off
            entity_id: light.woonkamer_groep
          - service: light.turn_off
            entity_id: light.keuken_groep
          - service: switch.turn_on
            data_template:
              entity_id: >
                {% if is_state("input_select.home_state", "Day")%}
                  switch.day_state
                {% else %}
                  switch.evening_state
                {% endif %}

      # Cinema Mode
      cinema_mode:
        friendly_name: Cinema Mode
        unique_id: switch_cinema_mode
        icon_template: mdi:movie-roll
        turn_on:
          - service: script.turn_on
            entity_id: script.mode_cinema
        turn_off:
          - service: light.turn_off
            entity_id: light.woonkamer_groep
          - service: adaptive_lighting.apply
            data:
              entity_id: switch.adaptive_lighting_ambilight
              lights: light.ambilight
          - service: switch.turn_on
            data_template:
              entity_id: >
                {% if is_state("input_select.home_state", "Day")%}
                  switch.day_state
                {% else %}
                  switch.evening_state
                {% endif %}


# █▀ ▀█▀ ▄▀█ ▀█▀ █▀▀   █▀▄▀█ █▀█ █▀▄ █ █▀▀ █ █▀▀ █▀█ █▀ #
# ▄█  █  █▀█  █  ██▄   █ ▀ █ █▄█ █▄▀ █ █▀  █ ██▄ █▀▄ ▄█ #

  - platform: template
    switches:
      # Switch for Home script
      home_modifier:
        friendly_name: Home Modifier
        unique_id: switch_home_modifier
        icon_template: mdi:home
        value_template: >-
          {{ is_state('input_select.home_state_modifier', 'Home') }}
        turn_on:
          - service: script.turn_on
            entity_id: script.home_modifier_home
        turn_off:
          - service: script.turn_off
            entity_id: script.home_modifier_home

      # Switch for Sleeping script
      sleeping_modifier:
        friendly_name: Sleeping Modifier
        unique_id: switch_sleeping_modifier
        icon_template: mdi:bell
        value_template: >-
          {{ is_state('input_select.home_state_modifier', 'Sleeping') }}
        turn_on:
          - service: script.turn_on
            entity_id: script.home_modifier_sleeping
        turn_off:
          - service: script.turn_off
            entity_id: script.home_modifier_sleeping

      # Switch for Away script
      away_modifier:
        friendly_name: Away Modifier
        unique_id: switch_away_modifier
        icon_template: mdi:map-marker
        value_template: >-
          {{ is_state('input_select.home_state_modifier', 'Away') 
             or is_state('input_select.home_state_modifier', 'On vacation')
          }}
        turn_on:
          - service: script.turn_on
            entity_id: script.home_modifier_away
        turn_off:
          - service: script.turn_off
            entity_id: script.home_modifier_away

      # Switch for On vacation Select
      on_vacation_modifier:
        friendly_name: On vacation Modifier
        unique_id: switch_on_vacation_modifier
        icon_template: mdi:arrow-right-thick
        value_template: >-
          {{ is_state('switch.away_modifier', 'on') 
             and is_state('input_select.home_state_modifier', 'On vacation')
          }}
        turn_on:
          - service: input_select.select_option
            entity_id: input_select.home_state_modifier
            data:
              option: On vacation
        turn_off:
          - service: switch.turn_on
            data_template:
              entity_id: >
                {% if is_state("switch.away_modifier", "on")%}
                  switch.away_modifier
                {% else %}
                  switch.home_modifier
                {% endif %}

# █ █ █▀█ █▀▄▀█ █▀▀   █▀ ▀█▀ ▄▀█ ▀█▀ █▀▀ █▀ #
# █▀█ █▄█ █ ▀ █ ██▄   ▄█  █  █▀█  █  ██▄ ▄█ #

  - platform: template
    switches:
      # Switch for Morning script
      morning_state:
        friendly_name: Morning State
        unique_id: switch_morning_state
        icon_template: mdi:weather-sunset-up
        value_template: >-
          {{ is_state('input_select.home_state', 'Morning')
             and is_state('cover.keuken_rolgordijnen', 'open')
             and is_state('light.voortuin_buitenlamp', 'off')
             and is_state('light.achtertuin_buitenlamp', 'off')
             }}
        turn_on:
          - service: script.turn_on
            entity_id: script.home_state_morning
          - service: switch.turn_off
            entity_id:
              - switch.day_state
              - switch.evening_state
              - switch.night_state
        turn_off:
          - service: script.turn_off
            entity_id: script.home_state_morning
      
      # Switch for Day script
      day_state:
        friendly_name: Day State
        unique_id: switch_day_state
        icon_template: mdi:weather-sunny
        value_template: >-
          {{ is_state('input_select.home_state', 'Day')
             and is_state('input_boolean.air_purifier', 'on')
             and is_state('cover.slaapkamer_rolgordijnen', 'open')
             and is_state('cover.keuken_rolgordijnen', 'open')
             }}
        turn_on:
          - service: script.turn_on
            entity_id: script.home_state_day
          - service: switch.turn_off
            entity_id:
              - switch.morning_state
              - switch.evening_state
              - switch.night_state
        turn_off:
          - service: script.turn_off
            entity_id: script.home_state_day

      # Switch for Evening script
      evening_state:
        friendly_name: Evening State
        unique_id: switch_evening_state
        icon_template: mdi:weather-sunset
        value_template: >-
          {{ is_state('input_select.home_state', 'Evening')
             and is_state('cover.keuken_rolgordijnen', 'closed')
             and is_state('cover.slaapkamer_rolgordijnen', 'closed')
             and is_state('light.voortuin_buitenlamp', 'on')
             and is_state('light.achtertuin_buitenlamp', 'on')
             }}
        turn_on:
          - service: script.turn_on
            entity_id: script.home_state_evening
          - service: switch.turn_off
            entity_id:
              - switch.morning_state
              - switch.day_state
              - switch.night_state
        turn_off:
          - service: script.turn_off
            entity_id: script.home_state_evening

      # Switch for Night script
      night_state:
        friendly_name: Night State
        unique_id: switch_night_state
        icon_template: mdi:weather-night
        value_template: >-
          {{ is_state('input_select.home_state', 'Night')
             and is_state('cover.keuken_rolgordijnen', 'closed')
             and is_state('cover.slaapkamer_rolgordijnen', 'closed')
             and is_state('light.voortuin_buitenlamp', 'on')
             and is_state('light.achtertuin_buitenlamp', 'on')
             }}
        turn_on:
          - service: script.turn_on
            entity_id: script.home_state_night
          - service: switch.turn_off
            entity_id:
              - switch.morning_state
              - switch.day_state
              - switch.evening_state
        turn_off:
          - service: script.turn_off
            entity_id: script.home_state_night